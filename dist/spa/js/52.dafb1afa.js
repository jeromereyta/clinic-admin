(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[52],{"85b0":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"row q-col-gutter-sm"},[n("div",{staticClass:"col-lg-12 col-md-12 col-sm-12 col-xs-12"},[n("q-card",{staticClass:"text-grey-8"},[n("q-card-section",{staticClass:"q-pa-none"},[n("q-table",{staticClass:"no-shadow",attrs:{data:e.data,title:"Queue","hide-header":"grid"===e.mode,columns:e.columns,"row-key":"name",filter:e.filter,pagination:e.pagination},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"top-right",fn:function(t){return[n("q-select",{staticStyle:{width:"400px","padding-bottom":"32px"},attrs:{filled:"","fill-input":"","input-debounce":"0",options:e.procedureOptions,hint:"Select Procedure",loading:e.queueLoading},model:{value:e.selectedProcedure,callback:function(t){e.selectedProcedure=t},expression:"selectedProcedure"}})]}},{key:"body-cell-Action",fn:function(t){return[n("q-td",{attrs:{props:t}},[1===t.row.queue_number&&"In Progress"!==t.row.status?n("q-btn",{attrs:{label:"Process",color:"pink",icon:"edit",size:"sm",flat:"",dense:""},on:{click:function(n){return e.confirmUpdateQueue(t.row,"on going")}}}):e._e(),n("q-btn",{staticClass:"q-ml-sm",attrs:{label:"Cancel",icon:"delete",size:"sm",flat:"",dense:"",color:"red"},on:{click:function(n){return e.confirmUpdateQueue(t.row,"cancelled")}}}),"In Progress"===t.row.status?n("q-btn",{staticClass:"q-ml-sm",attrs:{label:"Done",icon:"task_alt",size:"sm",color:"green",flat:"",dense:""},on:{click:function(n){return e.confirmUpdateQueue(t.row,"completed")}}}):e._e(),1===t.row.queue_number&&"In Progress"!==t.row.status?n("q-btn",{staticClass:"q-ml-sm",attrs:{label:"Move Down",icon:"arrow_downward",color:"blue",size:"sm",flat:"",dense:""},on:{click:function(n){return e.confirmUpdateQueue(t.row,"move one down in line")}}}):e._e()],1)]}}])}),n("q-dialog",{attrs:{persistent:""},model:{value:e.confirm,callback:function(t){e.confirm=t},expression:"confirm"}},[n("q-card",[n("q-card-section",{staticClass:"row items-center",staticStyle:{"background-color":"ghostwhite"}},[n("q-avatar",{attrs:{icon:"signal_wifi_off",color:"pink","text-color":"white"}}),n("span",{staticClass:"q-ml-sm",staticStyle:{color:"deeppink"}},[e._v("Proceed on updating this "),n("i",[e._v(e._s(e.selectedPatient)+"'s ")]),e._v(" procedure to "),n("b",[e._v(e._s(e.selectedStatus))]),e._v(" ?")])],1),n("q-card-actions",{staticStyle:{"background-color":"ghostwhite"},attrs:{align:"right"}},[n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel",color:"red"}}),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Update",color:"pink"},on:{click:function(t){return e.updateQueue()}}})],1)],1)],1),e.queueLoading?n("q-linear-progress",{attrs:{query:"",size:"10px",color:"blue"}}):e._e()],1)],1),n("q-inner-loading",{attrs:{showing:e.updateLoading}},[n("q-spinner-grid",{attrs:{size:"200px",color:"pink"}})],1)],1)])},s=[],o=(n("7db0"),n("4160"),n("b64b"),n("159b"),{name:"TableQueue",data:function(){return{updateLoading:!1,confirm:!1,patientProgress:{patient_name:null,patient_code:null},selectedItem:null,selectedStatus:null,selectedPatient:null,procedureOptions:[],selectedProcedure:null,filter:"",queueLoading:!1,mode:"list",columns:[{name:"queue_number",align:"left",label:"Queue #",field:"queue_number",sortable:!0},{name:"status",align:"left",label:"Status",field:"status",sortable:!0},{name:"patient_name",align:"left",label:"Patient Name",field:"patient_name",sortable:!0},{name:"patient_code",align:"left",label:"Patient Code",field:"patient_code",sortable:!0},{name:"Action",label:"Action",field:"Action",sortable:!1,align:"center"}],data:[],pagination:{rowsPerPage:10}}},created:function(){this.getQueues()},computed:{queuesComputed:function(){return this.$store.state.queues.queues}},watch:{selectedProcedure:function(e,t){var n=this,a=this.queuesComputed;Object.keys(a).forEach((function(t){var s=a[t];t===e&&(n.data=s)}))},data:function(e,t){var n=e.find((function(e){return"In Progress"===e.status}));void 0!==n&&this.$store.dispatch("queues/setPatientInProgress",n.patient_name,n.patient_code),void 0===n&&this.$store.dispatch("queues/setPatientInProgress",null,null)}},methods:{confirmUpdateQueue:function(e,t){this.confirm=!0,this.selectedItem=e,this.selectedPatient=e.patient_name,this.selectedStatus=t},updateQueue:function(e,t){var n=this;this.updateLoading=!0;var a="In Queue";"on going"===this.selectedStatus&&(a="In Progress"),"cancelled"===this.selectedStatus&&(a="Cancelled"),"completed"===this.selectedStatus&&(a="Done");var s=!1;"move one down in line"===this.selectedStatus&&(s=!0);var o={status:a,move_back:s,id:this.selectedItem.id};this.$store.dispatch("queues/updateProcedureQueue",o).then((function(e){401===e.status?n.$router.push("/UsersAdmin"):(n.updateLoading=!1,n.getQueues())}))},getQueues:function(){var e=this;this.updateLoading=!0,this.selectedProcedure=null,this.procedureOptions=[],this.$store.dispatch("queues/queueList").then((function(t){if(e.updateLoading=!1,401===t.status)e.$router.push("/UsersAdmin");else{var n=t.data;Object.keys(n).forEach((function(t){e.procedureOptions.push(t)})),e.selectedProcedure=e.procedureOptions[0]}}))}}}),i=o,r=n("2877"),l=n("f09f"),c=n("a370"),u=n("eaac"),d=n("ddd8"),p=n("db86"),m=n("9c40"),f=n("24e8"),g=n("cb32"),b=n("4b7e"),h=n("6b1d"),q=n("74f7"),w=n("981c"),v=n("7f67"),_=n("eebe"),P=n.n(_),Q=Object(r["a"])(i,a,s,!1,null,null,null);t["default"]=Q.exports;P()(Q,"components",{QCard:l["a"],QCardSection:c["a"],QTable:u["a"],QSelect:d["a"],QTd:p["a"],QBtn:m["a"],QDialog:f["a"],QAvatar:g["a"],QCardActions:b["a"],QLinearProgress:h["a"],QInnerLoading:q["a"],QSpinnerGrid:w["a"]}),P()(Q,"directives",{ClosePopup:v["a"]})}}]);